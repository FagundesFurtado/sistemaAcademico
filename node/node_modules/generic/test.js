var assert = require('assert');
var generic = require('./generic');

test('basics', function() {
  var jim = {type: 'person', name: 'jim'};
  var sue = {type: 'person', name: 'sue'};
  var stimbo = {type: 'horse', name: 'stimbo'};
  var carrots = {type: 'horse', name: 'carrots'};

  var isPerson = function(x) { return x && x.type == 'person'; };
  var isHorse = function(x) { return x && x.type == 'horse'; };

  assert(isPerson(sue));
  assert(isHorse(stimbo));
  assert(!isPerson(carrots));
  assert(!isHorse(jim));

  var meet = generic(function(a, b) {
    return 'nothing happens';
  });

  meet.method([isPerson, isPerson], function(person1, person2) {
    return person1.name + ' and ' + person2.name + ' play backgammon';
  });

  meet.method([isPerson, isHorse], function(person, horse) {
    return person.name + ' rides ' + horse.name;
  });

  meet.method([isHorse, isHorse], function(horse1, horse2) {
    return horse1.name + ' and ' + horse2.name + ' do horse stuff';
  });

  assert.equal(meet(jim, sue), 'jim and sue play backgammon');
  assert.equal(meet(sue, stimbo), 'sue rides stimbo');
  assert.equal(meet(carrots, stimbo), 'carrots and stimbo do horse stuff');
  assert.equal(meet(52, 'trousers'), 'nothing happens');
  assert.equal(meet(jim, 'trousers'), 'nothing happens');
  assert.equal(meet(jim, null), 'nothing happens');
  assert.equal(meet(null, sue), 'nothing happens');
});
